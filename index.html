<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Semester Grade Calculator</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #d1fae5 0%, #a7f3d0 100%);
            min-height: 100vh;
            margin: 0;
            padding: 20px;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .container {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            padding: 30px;
            border-radius: 20px;
            box-shadow: 0 8px 32px rgba(31, 38, 135, 0.15);
            max-width: 800px;
            width: 100%;
            text-align: center;
        }

        .logo {
            width: 150px;
            height: auto;
            margin-bottom: 20px;
        }

        /* ... (keep previous CSS styles) ... */
    </style>
</head>
<body>
    <div class="container">
        <img src="issig.png" alt="University Logo" class="logo">
        <h1>üìö Semester Grade Calculator</h1>
        
        <div class="semester-select">
            <select id="semesterSelect">
                <option value="1">Semester 1</option>
                <option value="2">Semester 2</option>
                <option value="3">Semester 3</option>
                <option value="4">Semester 4</option>
                <option value="5">Semester 5</option>
                <option value="6">Semester 6</option>
            </select>
        </div>

        <div id="subjectsContainer"></div>
        <div style="text-align: center;">
            <button onclick="calculateAverage()">Calculate Semester Average</button>
        </div>
        <div id="result"></div>
        <div id="creditsResult"></div>
    </div>

    <script>
        const subjectsBySemester = {
            1: [
                // Anatomie-Physiologie 1 (3 teachers)
                { 
                    name: "Anatomie-physiologie 1", 
                    coeff: 2.5, 
                    credits: 5,
                    isAnatomie: true 
                },
                // Other semester 1 subjects
                { name: "Introduction √† la Discipline infirmi√®re", coeff: 1.5, credits: 3 },
                { name: "D√©ontologie-Ethique", coeff: 1, credits: 2 },
                { name: "Psychologie du d√©veloppement social", coeff: 1, credits: 2, singleNote: true },
                // ... Add other semester 1 subjects
            ],
            // ... Add other semesters following the same pattern
        };

        function createSubjectInputs() {
            const semester = document.getElementById('semesterSelect').value;
            const subjects = subjectsBySemester[semester];
            const container = document.getElementById('subjectsContainer');
            container.innerHTML = '';

            subjects.forEach((subject, index) => {
                const card = document.createElement('div');
                card.className = 'subject-card';
                
                if (subject.isAnatomie) {
                    // Anatomie-Physiologie (3 DS/Exam pairs)
                    card.innerHTML = `
                        <h3>${subject.name} (Coeff: ${subject.coeff}, Cr: ${subject.credits})</h3>
                        <div class="input-group">
                            <input type="number" min="0" max="20" step="0.01" placeholder="DS 1" id="anat_ds1_${index}">
                            <input type="number" min="0" max="20" step="0.01" placeholder="Exam 1" id="anat_exam1_${index}">
                        </div>
                        <div class="input-group">
                            <input type="number" min="0" max="20" step="0.01" placeholder="DS 2" id="anat_ds2_${index}">
                            <input type="number" min="0" max="20" step="0.01" placeholder="Exam 2" id="anat_exam2_${index}">
                        </div>
                        <div class="input-group">
                            <input type="number" min="0" max="20" step="0.01" placeholder="DS 3" id="anat_ds3_${index}">
                            <input type="number" min="0" max="20" step="0.01" placeholder="Exam 3" id="anat_exam3_${index}">
                        </div>
                    `;
                }
                else if (subject.singleNote || subject.name.includes("Stage") || subject.name.includes("Techniques infirmi√®res")) {
                    // Single note subjects
                    card.innerHTML = `
                        <h3>${subject.name} (Coeff: ${subject.coeff}, Cr: ${subject.credits})</h3>
                        <div class="input-group">
                            <input type="number" min="0" max="20" step="0.01" placeholder="Note" id="note_${index}">
                        </div>
                    `;
                }
                else {
                    // Normal subjects with DS/Exam
                    card.innerHTML = `
                        <h3>${subject.name} (Coeff: ${subject.coeff}, Cr: ${subject.credits})</h3>
                        <div class="input-group">
                            <input type="number" min="0" max="20" step="0.01" placeholder="DS Note" id="ds_${index}">
                            <input type="number" min="0" max="20" step="0.01" placeholder="Exam Note" id="exam_${index}">
                        </div>
                    `;
                }
                container.appendChild(card);
            });
        }

        function calculateAverage() {
            const semester = document.getElementById('semesterSelect').value;
            const subjects = subjectsBySemester[semester];
            let total = 0;
            let totalCoeff = 0;
            let totalCredits = 0;
            let earnedCredits = 0;
            const warnings = [];
            const excludedSubjects = new Set(["C2I", "Psychologie", "Droit de patient"]);

            subjects.forEach((subject, index) => {
                let rawAverage = 0;
                let contribution = 0;

                if (subject.isAnatomie) {
                    // Calculate Anatomie average
                    const ds1 = parseFloat(document.getElementById(`anat_ds1_${index}`).value) || 0;
                    const exam1 = parseFloat(document.getElementById(`anat_exam1_${index}`).value) || 0;
                    const ds2 = parseFloat(document.getElementById(`anat_ds2_${index}`).value) || 0;
                    const exam2 = parseFloat(document.getElementById(`anat_exam2_${index}`).value) || 0;
                    const ds3 = parseFloat(document.getElementById(`anat_ds3_${index}`).value) || 0;
                    const exam3 = parseFloat(document.getElementById(`anat_exam3_${index}`).value) || 0;

                    const avg1 = (ds1 * 0.3) + (exam1 * 0.7);
                    const avg2 = (ds2 * 0.3) + (exam2 * 0.7);
                    const avg3 = (ds3 * 0.3) + (exam3 * 0.7);
                    rawAverage = (avg1 + avg2 + avg3) / 3;
                }
                else if (subject.singleNote || subject.name.includes("Stage") || subject.name.includes("Techniques infirmi√®res")) {
                    // Single note subjects
                    rawAverage = parseFloat(document.getElementById(`note_${index}`).value) || 0;
                }
                else {
                    // Normal subjects
                    const ds = parseFloat(document.getElementById(`ds_${index}`).value) || 0;
                    const exam = parseFloat(document.getElementById(`exam_${index}`).value) || 0;
                    rawAverage = (ds * 0.3) + (exam * 0.7);
                }

                // Calculate contribution and credits
                contribution = rawAverage * subject.coeff;
                total += contribution;
                totalCoeff += subject.coeff;
                totalCredits += subject.credits;

                if (rawAverage >= 10) {
                    earnedCredits += subject.credits;
                }

                // Check for controls
                const threshold = subject.name.includes("Techniques infirmi√®res") ? 8 : 6;
                if (rawAverage < threshold && !excludedSubjects.has(subject.name)) {
                    warnings.push(`Contr√¥le dans ${subject.name}`);
                }
            });

            const finalAverage = total / totalCoeff;
            let resultHTML = `Moyenne Semestrielle: ${finalAverage.toFixed(2)}/20`;
            
            if (warnings.length > 0) {
                resultHTML += `<br><br><span style="color: #dc2626;">Attention:</span><br>${warnings.join('<br>')}`;
            }

            document.getElementById('result').innerHTML = resultHTML;
            document.getElementById('creditsResult').innerHTML = 
                `Cr√©dits Totaux: ${totalCredits}<br>Cr√©dits Obtenus: ${earnedCredits}`;
        }

        // Initialize and set up event listeners
        document.addEventListener('DOMContentLoaded', createSubjectInputs);
        document.getElementById('semesterSelect').addEventListener('change', createSubjectInputs);
    </script>
</body>
</html>